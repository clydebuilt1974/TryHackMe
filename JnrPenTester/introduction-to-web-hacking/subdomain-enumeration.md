# Subdomain Enumeration

### **Subdomain Enumeration** <a href="#jcs2n77r8ro" id="jcs2n77r8ro"></a>

Process of finding valid subdomains for a domain.  Used to expand attack surface to try and discover more potential points of vulnerability.  Process of OSINT subdomain discovery requires many requests.  Automate using tools like[ Sublist3r](https://github.com/aboul3la/Sublist3r)

### **OSINT** <a href="#ipr8iwsn7pxo" id="ipr8iwsn7pxo"></a>

#### **SSL/TLS Certificates** <a href="#lki9beii6rki" id="lki9beii6rki"></a>

CA's (Certificate Authoritys) take part in "Certificate Transparency (CT) logs when an SSL/TLS (Secure Sockets Layer/Transport Layer Security) certificate is created for a domain by a CA.  These are publicly accessible logs of every SSL/TLS certificate created for a domain name.  Purpose of Certificate Transparency logs is to stop malicious and accidentally made certificates from being used.  Testers can use this service to discover subdomains belonging to a domain.  Sites like[ https://crt.sh](https://crt.sh/) and[ https://ui.ctsearch.entrust.com/ui/ctsearchui](https://ui.ctsearch.entrust.com/ui/ctsearchui) offer searchable database of certificates that shows current and historical results.

#### **Search Engines** <a href="#id-4e6lkbpiope0" id="id-4e6lkbpiope0"></a>

Contain trillions of links to more than a billion websites that can be an excellent resource for finding new subdomains.  Using advanced search methods on websites like Google, such as the site: filter, can narrow search results.

\-site:www.example.com site:\*.example.com would only contain results leading to the name example.com but exclude any links to www.example.com.  I.e. this would only subdomain names belonging to example.com.

#### **Domain Name Service (DNS) Bruteforce** <a href="#lbilbniiele9" id="lbilbniiele9"></a>

Method of trying tens, hundreds, thousands or even millions of different possible subdomains from a predefined list of commonly used subdomains.

`dnsrecon -t brt -d acmeitsupport.thm`

#### **Virtual Hosts** <a href="#rjeg5rbp27x2" id="rjeg5rbp27x2"></a>

Some subdomains are not hosted in publicly accessible DNS results:

* Development versions of a web application or administration portals.
* DNS record could be kept on a private DNS server or recorded on the developer's machines in their /etc/hosts file (or c:\windows\system32\drivers\etc\hosts file for Windows users) which maps domain names to IP addresses.

Web servers may host multiple websites from one server when a website is requested from a client, the server knows which website the client wants from the Host header.  Testers can make changes to the host header and monitor the response to see if a new website has been discovered.  This can be automated like with DNS Bruteforce by using a wordlist of commonly used subdomains.

#### **Use Ffuf to discover Hidden Subdomains** <a href="#hubemk5c46xq" id="hubemk5c46xq"></a>

1. Run `ffuf -w /usr/share/wordlists/SecLists/Discovery/DNS/namelist.txt -H "Host: FUZZ.acmeitsupport.thm" -u http://MACHINE_IP` to discover a hidden subdomain.
   * `-w` switch specifies the wordlist to use.
   * `-H` switch adds/edits a header.  In this instance the Host: header.
   * `FUZZ` keyword in the space where a subdomain would normally go.  This is where all the options from the wordlist will be tried.
2. Output needs to be filtered as the above command will always produce a valid result.
3. Run `ffuf -w /usr/share/wordlists/SecLists/Discovery/DNS/namelist.txt -H "Host: FUZZ.acmeitsupport.thm" -u http://MACHINE_IP -fs {size}`
   * `-fs` switch tells ffuf to ignore any results that are of the specified size.
   * Replace `{size}` with the most occurring size value from the first ffuf result
