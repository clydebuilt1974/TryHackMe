# Alfred
* Exploit a common misconfiguration on a widely used automation server (Jenkins).
  * Jenkins is used to create continuous integration/continuous development pipelines that allow developers to automatically deploy their code once they made changes to it).
* Use an interesting privilege escalation method to get full system access.
## Initial Access
* nmap scan to determine open TCP ports.
```
nmap -sT -sV -p- -oN TARGET_IP_scan.nmap TARGET_IP
```
```
Not shown: 65532 filtered ports
PORT     STATE SERVICE       VERSION
80/tcp   open  http          Microsoft IIS httpd 7.5
3389/tcp open  ms-wbt-server Microsoft Terminal Service
8080/tcp open  http          Jetty 9.4.z-SNAPSHOT
```
* Identify username and password for login panel.
* Send login attempt via Burpsuite.
  * Target > Project > Scope > Include "http://TARGET_IP:8080" in scope.
  * Ensure Interecpt is on.
  * Open inbuilt Chromium browser to intercept requests.
  * Proxy username and password of "12345" via login panel.
  * Forward request to Repeater.
  * Send to see the response.
    * `Location` header.
```
Location: http://TARGET_IP:8080/loginError
```
* Brutefore login panel using Hydra.
```
hydra -L /usr/share/wordlists/rockyou.txt -P /usr/share/wordlists/rockyou.txt TARGET_IP -s 8080 http-form-post "/j_acegi_security_check:j_username=^USER^&j_password=^PASS^:Invalid username or password"
```
  * Login or Wordlist for Usernames = `/usr/share/wordlists/rockyou.txt`.
  * Password or Wordlist for Passwords = `/usr/share/wordlists/rockyou.txt`.
  * IP address or Hostname = TARGET_IP.
  * HTTP Method (POST/GET) = `http-form-post`.
    * **Inspect Element** in browser.
    * **Network** tab of developer tools.
    * Attempt a login.
    * GET or POST Method displayed in request.
```
POST /j_acegi_security_check HTTP/1.1
```
  * Directory/Path to the Login Page = `/j_acegi_security_check`.
    * Request header "Filename" attribute contains this.
```
/j_acegi_security_check
```
  * Request Body for Username/Password = `j_username=^USER^&j_password=^PASS^&from=%2F&Submit=Sign+in`
    * **Inspect Element** in browser.
    * **Network** tab of developer tools.
    * Attempt a login.
    * Right click on request > **Edit and Resend**.
    * **Request Body** contains entered username and password.
    * Grab entire request.
```
j_username=12345&j_password=12345&from=%2F&Submit=Sign+in
```
    * Replace entered username with `^USER^ to tell Hydra to enter words from wordlist in this position of the request.
    * Replace entered password with ^PASS^. 
  * Way to Identify Failed Attempts = `Invalid username or password`.
    * Attempt to login using incorrect credentials.
    * Presented with "Invalid username or password" text.
    * Add this to Hydra command.
* Use [Nishang](https://github.com/samratashok/nishang) [reverse shell scripts](https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PowerShellTcp.ps1) to gain initial access.
 
